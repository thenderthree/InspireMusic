<script>
(function() {
  // 使用简单的哈希来存储密码(SHA-256)
  // 密码: 123456 的哈希值
  const PASSWORD_HASH = '8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92';
  
  // 简单的 SHA-256 实现
  async function sha256(message) {
    const msgBuffer = new TextEncoder().encode(message);
    const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
  }

  // 处理认证
  async function handleAuth(password) {
    const hash = await sha256(password);
    if (hash === PASSWORD_HASH) {
      sessionStorage.setItem('authenticated', 'true');
      sessionStorage.setItem('authTime', new Date().getTime().toString());
      toggleAuthOverlay(false);
    } else {
      showError();
      document.getElementById('password-input').value = '';
    }
  }

  // 表单提交事件
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('auth-form');
    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      const password = document.getElementById('password-input').value;
      await handleAuth(password);
    });
  });
})();
</script>
